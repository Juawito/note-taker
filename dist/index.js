let noteTitle,noteText,saveNoteBtn,newNoteBtn,noteList;"/notes"===window.location.pathname&&(noteTitle=document.querySelector(".note-title"),noteText=document.querySelector(".note-textarea"),saveNoteBtn=document.querySelector(".save-note"),newNoteBtn=document.querySelector(".new-note"),noteList=document.querySelectorAll(".list-container .list-group"));const show=a=>{a.style.display="inline"},hide=a=>{a.style.display="none"};let activeNote={};const getNotes=()=>fetch("/api/notes",{method:"GET",headers:{"Content-Type":"application/json"}}),saveNote=a=>fetch("/api/notes",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)}),deleteNote=a=>fetch(`/api/notes/${a}`,{method:"DELETE",headers:{"Content-Type":"application/json"}}),renderActiveNote=()=>{hide(saveNoteBtn),activeNote.id?(noteTitle.setAttribute("readonly",!0),noteText.setAttribute("readonly",!0),noteTitle.value=activeNote.title,noteText.value=activeNote.text):(noteTitle.removeAttribute("readonly"),noteText.removeAttribute("readonly"),noteTitle.value="",noteText.value="")},handleNoteSave=()=>{const a={title:noteTitle.value,text:noteText.value};saveNote(a).then(()=>{getAndRenderNotes(),renderActiveNote()})},handleNoteDelete=a=>{a.stopPropagation();const b=a.target,c=JSON.parse(b.parentElement.getAttribute("data-note")).id;activeNote.id===c&&(activeNote={}),deleteNote(c).then(()=>{getAndRenderNotes(),renderActiveNote()})},handleNoteView=a=>{a.preventDefault(),activeNote=JSON.parse(a.target.parentElement.getAttribute("data-note")),renderActiveNote()},handleNewNoteView=()=>{activeNote={},renderActiveNote()},handleRenderSaveBtn=()=>{noteTitle.value.trim()&&noteText.value.trim()?show(saveNoteBtn):hide(saveNoteBtn)},renderNoteList=async a=>{let b=await a.json();"/notes"===window.location.pathname&&noteList.forEach(a=>a.innerHTML="");let c=[];const d=(a,b=!0)=>{const c=document.createElement("li");c.classList.add("list-group-item");const d=document.createElement("span");if(d.innerText=a,d.addEventListener("click",handleNoteView),c.append(d),b){const a=document.createElement("i");a.classList.add("fas","fa-trash-alt","float-right","text-danger","delete-note"),a.addEventListener("click",handleNoteDelete),c.append(a)}return c};0===b.length&&c.push(d("No saved Notes",!1)),b.forEach(a=>{const b=d(a.title);b.dataset.note=JSON.stringify(a),c.push(b)}),"/notes"===window.location.pathname&&c.forEach(a=>noteList[0].append(a))},getAndRenderNotes=()=>getNotes().then(renderNoteList);"/notes"===window.location.pathname&&(saveNoteBtn.addEventListener("click",handleNoteSave),newNoteBtn.addEventListener("click",handleNewNoteView),noteTitle.addEventListener("keyup",handleRenderSaveBtn),noteText.addEventListener("keyup",handleRenderSaveBtn)),getAndRenderNotes();